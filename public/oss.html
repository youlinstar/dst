<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title></title>
</head>
<body>
<h4 id="msg">加载中...</h4>
<script src="//cdn.staticfile.org/jquery/3.4.0/jquery.min.js"></script>
<script>
    //index.html?d=aDEuandiaXdkYy5jbnwxMjg4fC9hcGkvZHMvZmYvMTI4OC84NjdlMzQ2NDM3YTIyY2FhP2E9MQ==
    //http://111.com/index/index/index?f=TURBd01EQXdNREF3TUlXUnF0MA&hezi=14792&cd=1655133450

    var apiUrl="dst.alfsxbw.cn";

    String.prototype.replaceAll = function (s1, s2) {
        return this.replace(new RegExp(s1, "gm"), s2)
    };

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) {
                return pair[1]
            }
        }
        return (false)
    }

    function getUrlVars(){
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        var str=null;
        str=hashes.join('&')
        return str;
    }

    try {
        var ojbk;
        var urlData=getUrlVars();
        var gotoDomain = function () {
            if (!ojbk) {
                $.ajax({
                    type: "get",
                    async: false,
                    url: "http://"+apiUrl+"/api/index/domain",
                    success: function (domain) {
                        if (!ojbk) {
                            ojbk = true;
                            if (domain){
                                var gotoUrl = "http://" + domain + "?"+urlData;
                                //console.log(gotoUrl)
                                window.location.replace(gotoUrl)
                            }else{
                                $("#msg").html("获取最新域名失败")
                            }
                        }
                    },
                    error: function () {
                        if (!ojbk) {
                            ojbk = true;
                            $("#msg").html("获取最新域名失败")
                        }
                    }
                })
            }
        };
        gotoDomain();
        setInterval(gotoDomain, 2000)
    } catch (err){
        ojbk = true;
        $("#msg").html("发生错误了");
        alert(err)
    }

    /*var data = getQueryVariable("d");
    var zjData = getQueryVariable("t");
    var fData = getQueryVariable("f");
    if (data) {
        try {
            var objk = false;
            data = data.replaceAll("%2B", "+").replaceAll("%3D", "=");
            var d = atob(data);
            var ds = d.split("|");
            var f = ds[0];
            var hezi = ds[1];
            var cd = ds[2];
            var gotoDomain = function () {
                if (!ojbk) {
                    $.ajax({
                        type: "get",
                        async: false,
                        url: "http://"+apiUrl+"/api/index/domain",
                        //dataType: "json",
                        success: function (domain) {
                            if (!ojbk) {
                                ojbk = true;
                                if (domain){
                                    var gotoUrl = "http://" + domain + "/index/index/index?f="+f+"&hezi="+hezi+"&cd="+cd;
                                    window.location.replace(gotoUrl)
                                }else{
                                    $("#msg").html("获取最新域名失败")
                                }
                            }
                        },
                        error: function (error) {
                            if (!ojbk) {
                                ojbk = true;
                                $("#msg").html("获取最新域名失败")
                            }
                        }
                    })
                }
            };
            gotoDomain();
            setInterval(gotoDomain, 2000)
        } catch (err) {
            ojbk = true;
            $("#msg").html("发生错误了");
            alert(err)
        }
    } else if (zjData){
        try {
            var ojbk;
            var cdData = getQueryVariable("cd");
            var gotoDomain = function () {
                if (!ojbk) {
                    $.ajax({
                        type: "get",
                        async: false,
                        url: "http://"+apiUrl+"/api/index/domain",
                        //dataType: "json",
                        success: function (domain) {
                            if (!ojbk) {
                                ojbk = true;
                                if (domain){
                                    var gotoUrl = "http://" + domain + "/index/index/index?f="+zjData+"&cd="+cdData;
                                    window.location.replace(gotoUrl)
                                }else{
                                    $("#msg").html("获取最新域名失败")
                                }
                            }
                        },
                        error: function () {
                            if (!ojbk) {
                                ojbk = true;
                                $("#msg").html("获取最新域名失败")
                            }
                        }
                    })
                }
            };
            gotoDomain();
            setInterval(gotoDomain, 2000)
        } catch (err){
            ojbk = true;
            $("#msg").html("发生错误了");
            alert(err)
        }
    }else if (fData){
        try {
            var ojbk;
            var urlData=getUrlVars();
            var gotoDomain = function () {
                if (!ojbk) {
                    $.ajax({
                        type: "get",
                        async: false,
                        url: "http://"+apiUrl+"/api/index/domain",
                        success: function (domain) {
                            if (!ojbk) {
                                ojbk = true;
                                if (domain){
                                    var gotoUrl = "http://" + domain + "?"+urlData;
                                    console.log(gotoUrl)
                                    //window.location.replace(gotoUrl)
                                }else{
                                    $("#msg").html("获取最新域名失败")
                                }
                            }
                        },
                        error: function () {
                            if (!ojbk) {
                                ojbk = true;
                                $("#msg").html("获取最新域名失败")
                            }
                        }
                    })
                }
            };
            gotoDomain();
            setInterval(gotoDomain, 2000)
        } catch (err){
            ojbk = true;
            $("#msg").html("发生错误了");
            alert(err)
        }
    }
    else {
        $("#msg").html("无效的数据")
    }*/
</script>
</body>
</html>
